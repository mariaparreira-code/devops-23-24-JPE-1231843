# Use a imagem oficial do Tomcat 9 com JDK 17
FROM tomcat:9-jdk17-openjdk-slim

# Instalação do Git
RUN apt-get update && apt-get install -y git

# Clonar o repositório com a aplicação Spring
RUN git clone https://github.com/mariaparreira-code/devops-23-24-JPE-1231843.git CA2.Part2/demoWithGradle

# Navegar até o diretório da aplicação
WORKDIR CA2.Part2/demoWithGradle

# Permissões e construção da aplicação
RUN chmod u+x gradlew && ./gradlew clean build

# Copiar o arquivo war gerado para o diretório webapps do Tomcat
RUN cp build/libs/basic-0.0.1-SNAPSHOT.war /usr/local/tomcat/webapps/
